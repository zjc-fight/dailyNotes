EMç®—æ³•åŸç†æ€»ç»“

------

> åœ¨æœºå™¨å­¦ä¹ é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€šè¿‡æ ·æœ¬çš„è§‚æµ‹æ•°æ®æ¥æ±‚è§£æ¨¡å‹å‚æ•°ï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯æå¤§åŒ–æ¨¡å‹åˆ†å¸ƒçš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ã€‚
> 
> ä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¾—åˆ°çš„è§‚æµ‹æ•°æ®å«æœ‰æœªè§‚æµ‹åˆ°çš„éšå«æ•°æ®ï¼Œæ­¤æ—¶æˆ‘ä»¬æœªçŸ¥çš„æœ‰éšå«æ•°æ®å’Œæ¨¡å‹å‚æ•°ï¼Œå°±ä¸èƒ½ç›´æ¥ç”¨æå¤§å¯¹æ•°ä¼¼ç„¶å‡½æ•°æ¥æ±‚è§£æ¨¡å‹å‚æ•°äº†ï¼ŒEMç®—æ³•å°±æ˜¯ç”¨æ¥æ±‚è§£è¿™ç±»é—®é¢˜çš„ã€‚
> 
> EMç®—æ³•æ˜¯ä¸€ä¸ªå¯å‘å¼çš„è¿­ä»£æ–¹æ³•ï¼Œæ—¢ç„¶æ— æ³•ç›´æ¥æ±‚å‡ºæ¨¡å‹å‚æ•°ï¼Œé‚£å°±å…ˆçŒœæµ‹å‡ºä¸€ç‰ˆéšå«æ•°æ®(Eæ­¥)ï¼Œç„¶åæ ¹æ®è§‚æµ‹æ•°æ®å’ŒçŒœæµ‹çš„éšå«æ•°æ®æ¥æ±‚å‡ºä¸€ç‰ˆæ¨¡å‹å‚æ•°(Mæ­¥)ï¼›ç”±äºéšå«æ•°æ®æ˜¯çŒœæµ‹å¾—åˆ°çš„ï¼Œæ‰€ä»¥è¿™æ—¶å€™æ±‚å‡ºçš„æ¨¡å‹å‚æ•°è¿˜ä¸æ˜¯ç†æƒ³çš„ç»“æœï¼Œæ¥ä¸‹æ¥ç»§ç»­ç”¨å¾—åˆ°çš„æ¨¡å‹å‚æ•°å’Œè§‚æµ‹æ•°æ®ï¼Œå†çŒœæµ‹å‡ºä¸€ç‰ˆéšå«æ•°æ®(Eæ­¥)ï¼Œç„¶åå†ç”¨è§‚æµ‹æ•°æ®å’Œéšå«æ•°æ®æ±‚å‡ºä¸€èˆ¬æ¨¡å‹å‚æ•°(Mæ­¥)ï¼Œå¦‚æ­¤å¾ªç¯ä¸‹å»ã€‚ã€‚ã€‚ã€‚ã€‚çŸ¥é“æ¨¡å‹å‚æ•°æ”¶æ•›ä¸ºæ­¢ã€‚
> 
> ä»ä¸Šé¢çš„æè¿°å¯ä»¥çœ‹å‡ºï¼ŒEMç®—æ³•æ˜¯è¿­ä»£æ±‚è§£æœ€å¤§å€¼çš„ç®—æ³•ï¼ŒåŒæ—¶ç®—æ³•åœ¨æ¯ä¸€æ¬¡è¿­ä»£æ—¶åˆ†ä¸ºä¸¤æ­¥ï¼ŒEæ­¥å’ŒMæ­¥ã€‚ä¸€è½®è½®è¿­ä»£æ›´æ–°éšå«æ•°æ®å’Œæ¨¡å‹åˆ†å¸ƒå‚æ•°ï¼Œç›´åˆ°æ”¶æ•›ï¼Œå³å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„æ¨¡å‹å‚æ•°ã€‚
> 
> ä¸€ä¸ªæœ€ç›´è§‚äº†è§£EMç®—æ³•æ€è·¯çš„æ˜¯K-Meansç®—æ³•ã€‚åœ¨K-Meansèšç±»æ—¶ï¼Œæ¯ä¸ªèšç±»ç°‡çš„è´¨å¿ƒæ˜¯éšå«æ•°æ®ã€‚æˆ‘ä»¬ä¼šå‡è®¾ğ¾ä¸ªåˆå§‹åŒ–è´¨å¿ƒï¼Œå³EMç®—æ³•çš„Eæ­¥ï¼›ç„¶åè®¡ç®—å¾—åˆ°æ¯ä¸ªæ ·æœ¬æœ€è¿‘çš„è´¨å¿ƒï¼Œå¹¶æŠŠæ ·æœ¬èšç±»åˆ°æœ€è¿‘çš„è¿™ä¸ªè´¨å¿ƒï¼Œå³EMç®—æ³•çš„Mæ­¥ã€‚é‡å¤è¿™ä¸ªEæ­¥å’ŒMæ­¥ï¼Œç›´åˆ°è´¨å¿ƒä¸å†å˜åŒ–ä¸ºæ­¢ï¼Œè¿™æ ·å°±å®Œæˆäº†K-Meansèšç±»ã€‚

# 1. EMç®—æ³•çš„æ•°å­¦æ¨å¯¼

å¯¹nä¸ªæ ·æœ¬çš„è§‚æµ‹æ•°æ®ä¸º$(x_1, x_2, ..., x_n)$ï¼Œæ±‚è§£æ¨¡å‹å‚æ•°ï¼Œé€šå¸¸ç”¨æå¤§å¯¹æ•°ä¼¼ç„¶ä¼°è®¡

$$L(\theta|x)=\sum_{i=1}^n logP(x_i;\theta)$$

å½“å­˜åœ¨ä¸å¯è§‚æµ‹æ•°æ®$(z_1, z_2,...,z_n)$æ—¶ï¼Œå¯¹æ•°ä¼¼ç„¶ä¼°è®¡ä¸º

$$L(\theta|x)=\sum_{i=1}^n log\sum_{z_i} P(x_i,z_i;\theta)$$

ç”±äºä¸Šå¼å­˜åœ¨$\theta$å’Œ$z$ä¸¤ä¸ªæœªçŸ¥å˜é‡ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æ±‚è§£ï¼Œåœ¨ä¸Šå¼å¼•å…¥ä¸€ä¸ªåˆ†å¸ƒ $Q(z)$

$$L(\theta|x)=\sum_{i=1}^nlog\sum_{z_i}Q_i(z_i)* \frac {P(x_i,z_i;\theta)}{Q_i(z_i)}$$

> Jensenä¸ç­‰å¼ï¼šè®¾$A$ä¸º$R^k$ä¸­å‡¸é›†ï¼Œ$f(\cdot)$ä¸º$A$ä¸Šçš„å‡¸å‡½æ•°ï¼Œå³å¯¹ä»»æ„$\lambda \in [0,1]$,$x,y \in A$, æœ‰
> $$f(\lambda x + (1-\lambda)y) \le \lambda f(x) + (1-\lambda)f(y)$$
> å¦‚æœ$k$ç»´éšæœºå˜é‡æ»¡è¶³$P(x \in A)=1$ï¼Œåˆ™æœ‰
> $$f(E(x)) \le E(f(x))$$
> å½“ä¸”ä»…å½“$f(x)$ä¸ºå¸¸æ•°æ—¶ï¼Œç­‰å·æˆç«‹ã€‚

ç”±äº$log$æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œåº”ç”¨Jensenä¸ç­‰å¼
$$L(\theta|x)=\sum_{i=1}^nlog\sum_{z_i}Q_i(z_i)* \frac {P(x_i,z_i;\theta)}{Q_i(z_i)}$$
$$\ge \sum_{i=1}^n\sum_{z_i}Q_i(z_i)* log\frac {P(x_i,z_i;\theta)}{Q_i(z_i)}$$
æ­¤æ—¶ï¼Œå¦‚æœè¦æ»¡è¶³Jensenä¸ç­‰å¼çš„ç­‰å·ï¼Œåˆ™æœ‰
$$\frac {P(x_i,z_i;\theta)}{Q_i(z_i)}=c$$
cä¸ºå¸¸æ•°

åˆç”±äº$Q_i(z_i)$æ˜¯ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œåˆ™æœ‰

$$\sum_z Q_i(z_i)=1$$

ç”±ä¸Šé¢ä¸¤å¼ï¼Œå¯ä»¥å¾—åˆ°

$$
Q_i(z_i) = \frac {P(x_i,z_i;\theta)}{\sum_z P(x_i,z_i;\theta)} = \frac {P(x_i,z_i;\theta)}{P(x_i;\theta)} = P(z_i|x_i;\theta) =: q^*(z_i|\theta)
$$

æ‰€ä»¥ï¼Œæ–°å¼•å…¥çš„åˆ†å¸ƒ$Q_i(x_i)$å¯ä»¥çœ‹ä½œ$x_i$æ¡ä»¶ä¸‹$z_i$çš„æ¡ä»¶æ¦‚ç‡ã€‚
æ­¤æ—¶

$$
L(\theta|x) = \sum_{i=1}^n\sum_{z_i}q^\*(z_i|\theta)* log\frac {P(x_i,z_i;\theta)}{q^\*(z_i|\theta)} = F(q^\*(z_i|\theta), \theta)
$$


å‡è®¾ç¬¬$t$æ­¥çš„ä¼°è®¡å€¼ä¸º$\theta_t$,æ„é€ å¦‚ä¸‹è¿­ä»£ç®—æ³•

$$
\theta_{t+1} = arg max_{\theta}\sum_{i=1}^n\sum_{z_i}q^\*(z_i|\theta_t) * log\frac {P(x_i,z_i;\theta)}{q^\*(z_i|\theta_t)}
$$

ç”±äº$q^\*(z_i|\theta_t) * log\frac {P(x_i,z_i;\theta)}{q^\*(z_i|\theta_t)}=q^\*(z_i|\theta_t) * logP(x_i,z_i;\theta) - q^\*(z_i|\theta_t) * log(q^\*(z_i|\theta_t))$ï¼Œæœ€åä¸€é¡¹ä¸$\theta$æ— å…³ï¼Œå¯ä»¥çœç•¥
æ‰€ä»¥ä¼˜åŒ–é—®é¢˜ç­‰ä»·äº

$$
\theta_{t+1}=arg max_{\theta}\sum_{i=1}^n\sum_{z_i}q^\*(z_i|\theta_t) * logP(x_i,z_i;\theta)
$$

æ³¨æ„åˆ°ï¼Œ$L(\theta_{t+1}|x) \ge F(q^\*(z_i|\theta_t), \theta_{t+1}) \ge F(q^\*(z_i|\theta_t), \theta_t)=L(\theta_t|x)$ã€‚å¦‚æœ$P(x,z;\theta_{t+1})/P(x,z|\theta_t)$ä¸$z$ç›¸å…³ï¼ˆå³ä¸ä¸ºå¸¸æ•°æ—¶ï¼‰ï¼Œæœ‰$L(\theta_{t+1}|x) \gt L(\theta_t|x)$ï¼Œæ‰€ä»¥ï¼Œè¯¥è¿­ä»£ç®—æ³•ä½¿å¾—ä¼¼ç„¶å‡½æ•°å•è°ƒé€’å¢ï¼Œå¦‚æœ$\theta_t$æ”¶æ•›åˆ°$\theta^\*$ï¼Œé‚£ä¹ˆåœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶ä¸‹ï¼Œ$\theta^\*$ä¸ºä¼¼ç„¶å‡½æ•°çš„é©»ç‚¹ã€‚è¯¥æ€§è´¨ä¿è¯äº†EMç®—æ³•çš„æ”¶æ•›æ€§ã€‚



# 2. EMç®—æ³•çš„æµç¨‹
è¾“å…¥ï¼šè§‚æµ‹æ•°æ®$(x_1,x_2,...,x_m)$ï¼Œè”åˆæ¦‚ç‡åˆ†å¸ƒ$P(x,z;\theta)$ï¼Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ$P(z|x;\theta)$ã€‚

1. Eæ­¥ï¼šè®¡ç®—æ¡ä»¶æ¦‚ç‡æœŸæœ›
$$Q_i(z_j)=P(z_i|x_i;\theta_t)$$
$$L(\theta|x;\theta_t)=\sum_{i=1}^m \sum_{z_i}Q_i(x_i)*logP(x_i,z_i;\theta)$$
2. Mæ­¥ï¼šæå¤§åŒ–$L(\theta|x;\theta_t)$ï¼Œå¾—åˆ°$\theta_{t+1}$
$$\theta_{t+1}=argmax_{\theta}L(\theta|x;\theta_t)$$
3. åˆ¤æ–­$\theta_{t+1}$æ˜¯å¦æ”¶æ•›ï¼Œå¦åˆ™ç»§ç»­ç¬¬ä¸€æ­¥ã€‚



